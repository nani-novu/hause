<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Title - Hause</title>
    <link rel="stylesheet" href="assets/css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Fluid Player CSS -->
    <link rel="stylesheet" href="https://cdn.fluidplayer.com/v3/current/fluidplayer.min.css" type="text/css"/>
</head>
<body>
    
    <!-- Navbar (Same as Index) -->
    <nav class="navbar">
        <div class="logo"><a href="index.html">Hause</a></div>
        <div class="nav-right">
            <div class="search-container">
                <i class="fa-solid fa-magnifying-glass"></i>
                <input type="text" id="searchInput" placeholder="Search...">
            </div>
            <div class="v-divider"></div>
            <div id="themeToggle" style="cursor: pointer; display: flex; align-items: center;">
                 <!-- SVG will be injected by script.js -->
                 <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0"/><path d="M3 12h1m8 -9v1m8 8h1m-9 8v1m-6.4 -15.4l.7 .7m12.1 -.7l-.7 .7m0 11.4l.7 .7m-12.1 -.7l-.7 .7" /></svg>
            </div>
            <i class="fas fa-bars hamburger" id="hamburgerBtn"></i>
        </div>
    </nav>
    
    <div class="mobile-menu" id="mobileMenu">
        <a href="index.html">Home</a>
        <a href="">Categories</a>
        <a href="">Live Cams</a>
        <a href="">Premium</a>
        <a href="" style="color: var(--primary-pink);">Sign In</a>
    </div>

    <main class="player-container">
        
        <!-- Breadcrumbs -->
        <div class="breadcrumb">
            <a href="index.html" class="crumb-link">Home</a>
            <i class="fas fa-chevron-right crumb-sep"></i>
            <a href="#" class="crumb-link">Categories</a>
            <i class="fas fa-chevron-right crumb-sep"></i>
            <span class="crumb-current">My Best Friend's Hot Sister in the Kitchen</span>
        </div>

        <!-- Video Player Wrapper -->
<div class="video-wrapper">
    <!-- HD Overlay -->
    <div class="hd-badge">HD</div>
    
    <!-- === IN-PLAYER AD OVERLAY === -->
    <div id="inPlayerAd" class="player-ad-overlay">
        <div class="player-ad-content">
            <div class="ad-pill-header">
                <div class="ad-pill-icon"><i class="fas fa-play"></i></div>
                <div class="ad-pill-text">Watch AD for 3 seconds to unlock video</div>
            </div>

            <!-- Main Interface -->
            <div id="adMainInterface">
                 <p style="color: var(--text-gray); font-size: 13px; margin-bottom: 15px;" id="adInstruction">
                 </p>
                 <div class="ad-btn-row">
                    <button id="playerAdCancel" class="btn-player-cancel">Cancel</button>
                    <button id="playerAdUnlock" class="btn-player-unlock">Unlock</button>
                 </div>
            </div>

            <!-- Loading/Redirect Interface -->
            <div id="adLoadingInterface" class="ad-loading-state">
                <div class="spinner" style="width: 30px; height: 30px; border-width: 3px;"></div>
                <p class="redirect-text">Redirecting you to partner...</p>
            </div>
        </div>
    </div>
    <!-- === END OVERLAY === -->

    <video id="hause-player">
        <source src="assets/img/Zeo8WYpFtg8ut45H.mp4" data-fluid-hd title="1080p" type="video/mp4"/>
    </video>
</div>

        <!-- Video Info -->
        <div class="video-info-sec">
            <h1 class="video-main-title">My Best Friend's Hot Sister in the Kitchen | 12:45</h1>
            <div class="view-counter-wrapper">
                <i class="fas fa-eye"></i> <span id="viewCounter">13, 467</span> views
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons">
            <button class="btn-action btn-download">
                <i class="fas fa-download"></i> Download
            </button>
            <button class="btn-action btn-share">
                <i class="fas fa-share-nodes"></i> Share
            </button>
        </div>

        <!-- Related Videos -->
        <section class="category-section" style="margin-top: 40px; padding-left:0; padding-right:0;">
            <div class="section-header" style="padding-left: 20px;">
                <h2 class="section-title">Related Videos</h2>
            </div>
            
            
        <div class="loader-container">
            <div class="spinner"></div>
        </div>

    </main>

    <!-- Footer (Same as Index) -->
    <footer>
        <div class="social-icons">
            <a href=""><i class="fab fa-instagram"></i></a>
            <a href=""><i class="fab fa-twitter"></i></a>
            <a href=""><i class="fab fa-spotify"></i></a>
            <a href=""><i class="fab fa-reddit-alien"></i></a>
            <a href=""><i class="fab fa-linkedin"></i></a>
        </div>
        <p class="footer-text">&copy; 2005 - 2026 Hause Videodienste GmbH</p>
        <p class="footer-text">Quellbornstr. 36. 65201 Wiesbaden - Germany Tel 0611 16898917</p>
        <a href="" class="footer-text" style="color:#666; cursor: none;">18 U.S.C. 2257 Record-Keeping Requirements Compliance Statement</a>
    </footer>

    <!-- Fixed Button -->
    <a href="#" class="fixed-watch-btn">WATCH<br>FREE</a>

    <!-- Modals (Copied for functionality) -->
    <div id="modalOverlay" class="modal-overlay"></div>
    <div id="ageModal" class="custom-modal age-modal">
        <div class="modal-header-center"><h2 class="modal-title-serif">HAUSE</h2></div>
        <div class="age-content">
            <p class="warning-text"><strong>All Hause websites!</strong> <span style="color:#ccc">websites are gambling</span></p>
            <p class="legal-text">This website is strictly limited to those over 18 or of legal age in your jurisdiction, whichever is greater.</p>
            <button id="ageEnterBtn" class="btn-full-pink">I'M 18 OR OLDER - ENTER</button>
            <a href="#" id="ageExitBtn" class="exit-link">I'm less than 18 - Exit</a>
        </div>
    </div>
    <div id="cookieModal" class="custom-modal cookie-modal">
        <div class="cookie-header"><h3>Privacy Preferences</h3><p class="cookie-desc">Cookies Consent...</p></div>
        <div class="cookie-actions"><button id="cookieAcceptBtn" class="btn-full-pink">ACCEPT ALL COOKIES</button></div>
    </div>
    
    <!-- === AD UNLOCK MODAL === -->
<div id="adUnlockModal" class="modal-overlay" style="display: none; z-index: 10000;">
    <div class="ad-modal-content">
        <!-- Top Red Section -->
        <div class="ad-header-box">
            <div class="ad-icon-wrapper">
                <i class="fas fa-play"></i>
            </div>
            <div class="ad-text-content">
                <span class="ad-title">Watch AD for 1 free ep</span>
                <span class="ad-counter">0/3</span>
            </div>
        </div>

        <!-- Feedback Message Area -->
        <div id="adFeedbackMsg" class="ad-feedback" style="display: none;"></div>

        <!-- Buttons -->
        <div class="ad-buttons-row">
            <button id="adCancelBtn" class="btn-ad-cancel">Cancel</button>
            <button id="adUnlockBtn" class="btn-ad-unlock">Unlock</button>
        </div>
    </div>
</div>

    <!-- Fluid Player JS -->
    <script src="https://cdn.fluidplayer.com/v3/current/fluidplayer.min.js"></script>
    <!-- Main Script -->
    <script src="assets/js/script.js"></script>

    <!-- Player Specific Script -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
        
        // --- CONFIG ---
        const AD_URL = "https://www.google.com"; 
        const REQUIRED_TIME = 3000; // 3 seconds
        const VIDEO_SRC = "https://cdn.fluidplayer.com/videos/valerian-1080p.mkv";

        // --- STATE ---
        let isUnlocked = false;
        let adStartTime = 0;
        let pendingAction = null; // 'play' or 'download'

        // --- ELEMENTS ---
        const overlay = document.getElementById('inPlayerAd');
        const mainInterface = document.getElementById('adMainInterface');
        const loadInterface = document.getElementById('adLoadingInterface');
        const instructionTxt = document.getElementById('adInstruction');
        
        // --- FLUID PLAYER INIT ---
        var myFP = fluidPlayer(
            'hause-player',	{
                "layoutControls": {
                    "controlBar": { "autoHide": true, "animated": true },
                    "autoPlay": false,
                    "mute": false,
                    "playButtonShowing": true,
                    "playPauseAnimation": true,
                    "fillToContainer": true, // Critical for CSS fit
                    "posterImage": "assets/img/hero.gif"
                }
            }
        );

        // --- INTERCEPT PLAY ---
        myFP.on('play', function() {
            if (!isUnlocked) {
                myFP.pause(); // Force pause
                pendingAction = 'play';
                showOverlay();
            }
        });

        // --- INTERCEPT DOWNLOAD ---
        document.querySelector('.btn-download').addEventListener('click', (e) => {
            if (!isUnlocked) {
                e.preventDefault();
                pendingAction = 'download';
                showOverlay();
            } else {
                startDownload();
            }
        });

        // --- UI LOGIC ---

        function showOverlay() {
            overlay.style.display = 'flex';
            // Reset UI states
            mainInterface.style.display = 'block';
            loadInterface.style.display = 'none';
            instructionTxt.innerText = "Watch an ad for 3 seconds to unlock content.";
            instructionTxt.style.color = "var(--text-gray)";
        }

        // 1. Cancel Click
        document.getElementById('playerAdCancel').addEventListener('click', () => {
            // Hide overlay, but video remains paused/locked
            overlay.style.display = 'none';
            pendingAction = null;
        });

        // 2. Unlock Click
        document.getElementById('playerAdUnlock').addEventListener('click', () => {
            // Switch to Loading State
            mainInterface.style.display = 'none';
            loadInterface.style.display = 'flex';

            // 1.5 Second Delay before redirect
            setTimeout(() => {
                // Record time
                adStartTime = Date.now();
                // Open Link
                window.open(AD_URL, '_blank');
            }, 1500);
        });

        // --- VERIFY RETURN ---
        document.addEventListener("visibilitychange", () => {
            // Only check if overlay is open, loading state is active, and we are visible
            if (document.visibilityState === "visible" && overlay.style.display === 'flex' && loadInterface.style.display === 'flex') {
                
                if (adStartTime === 0) return; // Should not happen if logic flows correctly

                const elapsed = Date.now() - adStartTime;

                if (elapsed >= REQUIRED_TIME) {
                    // SUCCESS
                    handleSuccess();
                } else {
                    // FAIL - Return to Main Interface with Error
                    loadInterface.style.display = 'none';
                    mainInterface.style.display = 'block';
                    
                    const remaining = Math.ceil((REQUIRED_TIME - elapsed) / 1000);
                    instructionTxt.innerText = `Too early! You must watch for ${remaining} more seconds.`;
                    instructionTxt.style.color = "#ff0055";
                    
                    // Reset start time so they must click unlock again
                    adStartTime = 0;
                }
            }
        });

        function handleSuccess() {
            isUnlocked = true;
            overlay.style.display = 'none';
            
            // Perform pending action
            if (pendingAction === 'play') {
                myFP.play();
            } else if (pendingAction === 'download') {
                startDownload();
            }
        }

        function startDownload() {
            const a = document.createElement('a');
            a.href = VIDEO_SRC;
            a.download = 'video-download.mp4';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }
            
        // --- 8. VIEW COUNTER (Your existing code) ---
        const viewDisplay = document.getElementById('viewCounter');
        const storageKey = 'hause_video_views_ID123'; 
        const startingViews = 54230; 

        let currentViews = localStorage.getItem(storageKey);
        if (!currentViews) {
            currentViews = startingViews;
        } else {
            currentViews = parseInt(currentViews) + 1;
        }
        localStorage.setItem(storageKey, currentViews);
        viewDisplay.innerText = parseInt(currentViews).toLocaleString();

    });
</script>
</body>
</html>
